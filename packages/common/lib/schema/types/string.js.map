{"version":3,"sources":["../../../src/schema/types/string.js"],"names":["stringFunctions","stringTryParse","isString","parsedSuccess","isNull","defaultCase","v","toString","options","maxLength","defaultValue","isValid","n","requirementDescription","parse","toNumberOrNull","values","length","s","allowDeclaredValuesOnly","isBoolean","toBoolOrNull","typeConstraints","val","opts","str"],"mappings":"uGAAA;AACA;;;;;;AAMA;;;;;;;;;AASA,IAAMA,eAAe,GAAG,gCAAc;AACpC,aAAS,kBAAS,IAAT,CAD2B,EAAd,CAAxB;;;AAIA,IAAMC,cAAc,GAAG;AACrB,CAACC,YAAD,EAAWC,0BAAX,CADqB;AAErB,CAACC,UAAD,EAASD,0BAAT,CAFqB;AAGrB,CAACE,kBAAD,EAAc,UAAAC,CAAC,UAAI,gCAAcA,CAAC,CAACC,QAAF,EAAd,CAAJ,EAAf,CAHqB,CAAvB;;;AAMA,IAAMC,OAAO,GAAG;AACdC,EAAAA,SAAS,EAAE;AACTC,IAAAA,YAAY,EAAE,IADL;AAETC,IAAAA,OAAO,EAAE,iBAAAC,CAAC,UAAIA,CAAC,KAAK,IAAN,IAAe,0BAAcA,CAAd,KAAoBA,CAAC,GAAG,CAA3C,EAFD;AAGTC,IAAAA,sBAAsB;AACpB,uEAJO;AAKTC,IAAAA,KAAK,EAAEC,qBALE,EADG;;AAQdC,EAAAA,MAAM,EAAE;AACNN,IAAAA,YAAY,EAAE,IADR;AAENC,IAAAA,OAAO,EAAE,iBAAAL,CAAC;AACRA,QAAAA,CAAC,KAAK,IAAN,IAAe,4BAAgBA,CAAhB,KAAsBA,CAAC,CAACW,MAAF,GAAW,CAAjC,IAAsCX,CAAC,CAACW,MAAF,GAAW,KADxD,GAFJ;AAINJ,IAAAA,sBAAsB;AACpB,0EALI;AAMNC,IAAAA,KAAK,EAAE,eAAAI,CAAC,UAAIA,CAAJ,EANF,EARM;;AAgBdC,EAAAA,uBAAuB,EAAE;AACvBT,IAAAA,YAAY,EAAE,KADS;AAEvBC,IAAAA,OAAO,EAAES,aAFc;AAGvBP,IAAAA,sBAAsB,EAAE,+CAHD;AAIvBC,IAAAA,KAAK,EAAEO,mBAJgB,EAhBX,EAAhB;;;;AAwBA,IAAMC,eAAe,GAAG;AACtB;AACE,UAACC,GAAD,EAAMC,IAAN;AACED,IAAAA,GAAG,KAAK,IAAR,IAAgBC,IAAI,CAACf,SAAL,KAAmB,IAAnC,IAA2Cc,GAAG,CAACN,MAAJ,IAAcO,IAAI,CAACf,SADhE,GADF;AAGE,UAACc,GAAD,EAAMC,IAAN,oDAAkDA,IAAI,CAACf,SAAvD,GAHF,CADsB;;AAMtB;AACE,UAACc,GAAD,EAAMC,IAAN;AACED,IAAAA,GAAG,KAAK,IAAR;AACAC,IAAAA,IAAI,CAACL,uBAAL,KAAiC,KADjC;AAEA,sBAASI,GAAT,EAAcC,IAAI,CAACR,MAAnB,CAHF,GADF;AAKE,UAAAO,GAAG,sBAAQA,GAAR,sDALL,CANsB,CAAxB,C;;;;AAee;AACb,QADa;AAEbtB,cAFa;AAGbD,eAHa;AAIbQ,OAJa;AAKbc,eALa;AAMb,OANa;AAOb,UAAAG,GAAG,UAAIA,GAAJ,EAPU,C","sourcesContent":["import { constant, isString, isNull, includes, isBoolean } from \"lodash/fp\"\nimport {\n  typeFunctions,\n  makerule,\n  parsedSuccess,\n  getDefaultExport,\n} from \"./typeHelpers\"\nimport {\n  switchCase,\n  defaultCase,\n  toBoolOrNull,\n  toNumberOrNull,\n  isSafeInteger,\n  isArrayOfString,\n} from \"../../common/index.js\"\n\nconst stringFunctions = typeFunctions({\n  default: constant(null),\n})\n\nconst stringTryParse = switchCase(\n  [isString, parsedSuccess],\n  [isNull, parsedSuccess],\n  [defaultCase, v => parsedSuccess(v.toString())]\n)\n\nconst options = {\n  maxLength: {\n    defaultValue: null,\n    isValid: n => n === null || (isSafeInteger(n) && n > 0),\n    requirementDescription:\n      \"max length must be null (no limit) or a greater than zero integer\",\n    parse: toNumberOrNull,\n  },\n  values: {\n    defaultValue: null,\n    isValid: v =>\n      v === null || (isArrayOfString(v) && v.length > 0 && v.length < 10000),\n    requirementDescription:\n      \"'values' must be null (no values) or an array of at least one string\",\n    parse: s => s,\n  },\n  allowDeclaredValuesOnly: {\n    defaultValue: false,\n    isValid: isBoolean,\n    requirementDescription: \"allowDeclaredValuesOnly must be true or false\",\n    parse: toBoolOrNull,\n  },\n}\n\nconst typeConstraints = [\n  makerule(\n    (val, opts) =>\n      val === null || opts.maxLength === null || val.length <= opts.maxLength,\n    (val, opts) => `value exceeds maximum length of ${opts.maxLength}`\n  ),\n  makerule(\n    (val, opts) =>\n      val === null ||\n      opts.allowDeclaredValuesOnly === false ||\n      includes(val)(opts.values),\n    val => `\"${val}\" does not exist in the list of allowed values`\n  ),\n]\n\nexport default getDefaultExport(\n  \"string\",\n  stringTryParse,\n  stringFunctions,\n  options,\n  typeConstraints,\n  \"abcde\",\n  str => str\n)\n"],"file":"string.js"}